# 安装部署
## 导入镜像
在extract_tables.jar文件夹下，运行下面的命令
```
docker load -i extract_tables.jar
```
## 运行服务
将ALI_OCR_IP修改为阿里OCR服务器的IP，运行下面的命令
```
ALI_OCR_IP=192.168.2.13
docker run -d --net  host --name extract_tables --restart always -e ALI_OCR_IP=$ALI_OCR_IP extract_tables
```
## 测试服务状态
浏览器访问http://127.0.0.1:6060/，如果返回'passed!',表示状态正常
# 接口说明
## 请求
- 请求方式  
http post
- 端口  
6060
- 地址  
/extractTable
- 参数  
表单请求

|参数名|类型|含义|
|---|---|---|
|Img|file|传入表格图片|
| return_json|string|为‘true',返回json数据，否则返回xlsx文件 |

## 返回结果
- 如果 请求参数 ‘return_json’ 等于 ‘true' ,返回json格式字符串：  
status表示服务器状态（1--成功）   
xsc表示单元格**开始列**序号（从1开始）    
xec表示单元格**结束列**序号（从1开始）  
ysc表示单元格**开始行**序号（从1开始）   
yec表示单元格**结束行**序号（从1开始）   
word表示单元格内容
```json
{
	"status": 1, 
	"data": [
		[{
			"word": "\n",
			"xec": 1,
			"xsc": 1,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 16,
			"ysc": 16
		}, {
			"word": "\n",
			"xec": 1,
			"xsc": 1,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 15,
			"ysc": 15
		}, {
			"word": "\n",
			"xec": 1,
			"xsc": 1,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 14,
			"ysc": 14
		}, {
			"word": "\n",
			"xec": 1,
			"xsc": 1,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 13,
			"ysc": 13
		}, {
			"word": "\n",
			"xec": 1,
			"xsc": 1,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 12,
			"ysc": 12
		}, {
			"word": "10",
			"xec": 1,
			"xsc": 1,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 11,
			"ysc": 11
		}, {
			"word": "9",
			"xec": 1,
			"xsc": 1,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 10,
			"ysc": 10
		}, {
			"word": "8",
			"xec": 1,
			"xsc": 1,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 2,
			"xsc": 2,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 6,
			"xsc": 6,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 4,
			"xsc": 4,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 9,
			"ysc": 9
		}, {
			"word": "7",
			"xec": 1,
			"xsc": 1,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "7",
			"xec": 6,
			"xsc": 6,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "\u793e\u4f1a\u8c03\u67e5\u59d4\u6258\u51fd",
			"xec": 4,
			"xsc": 4,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 8,
			"ysc": 8
		}, {
			"word": "6",
			"xec": 1,
			"xsc": 1,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "6",
			"xec": 6,
			"xsc": 6,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "\n",
			"xec": 5,
			"xsc": 5,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "\u79fb\u9001\u5ba1\u67e5\u8d77\u8bc9\u544a\u77e5\u4e66",
			"xec": 4,
			"xsc": 4,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 7,
			"ysc": 7
		}, {
			"word": "5",
			"xec": 1,
			"xsc": 1,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "5",
			"xec": 6,
			"xsc": 6,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "\u88ab\u53d6\u4fdd\u5019\u5ba1\u4eba\u4e49\u52a1\u544a\u77e5\u4e66",
			"xec": 4,
			"xsc": 4,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "\n",
			"xec": 3,
			"xsc": 3,
			"yec": 6,
			"ysc": 6
		}, {
			"word": "4",
			"xec": 1,
			"xsc": 1,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "4",
			"xec": 6,
			"xsc": 6,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "\u6536\u53d6\u4fdd\u8bc1\u91d1\u901a\u77e5\u4e66",
			"xec": 4,
			"xsc": 4,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "\u6210\u516c\u4ea4\u6536\u4fdd\u5b57[2017]10527\u53f7",
			"xec": 3,
			"xsc": 3,
			"yec": 5,
			"ysc": 5
		}, {
			"word": "3",
			"xec": 1,
			"xsc": 1,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "",
			"xec": 7,
			"xsc": 7,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "3",
			"xec": 6,
			"xsc": 6,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "\u53d6\u4fdd\u5019\u5ba1\u51b3\u5b9a\u4e66",
			"xec": 4,
			"xsc": 4,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "\u6210\u516c\u4ea4\u53d6\u4fdd\u5b57[2017]10527\u53f7",
			"xec": 3,
			"xsc": 3,
			"yec": 4,
			"ysc": 4
		}, {
			"word": "2",
			"xec": 1,
			"xsc": 1,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "2",
			"xec": 6,
			"xsc": 6,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "\u7acb\u6848\u51b3\u5b9a\u4e66",
			"xec": 4,
			"xsc": 4,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "\u6210\u516c\u4ea4\u7acb\u5b57[2017]10557\u53f7",
			"xec": 3,
			"xsc": 3,
			"yec": 3,
			"ysc": 3
		}, {
			"word": "1",
			"xec": 1,
			"xsc": 1,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "\u6210\u90fd\u5e02\u516c\u5b89\u5c40\u4ea4\u901a\u7ba1\u7406\u5c40",
			"xec": 2,
			"xsc": 2,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "\n",
			"xec": 7,
			"xsc": 7,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "1",
			"xec": 6,
			"xsc": 6,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "20170328",
			"xec": 5,
			"xsc": 5,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "\u53d7\u6848\u767b\u8bb0\u8868",
			"xec": 4,
			"xsc": 4,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "\u6210\u516c\u4ea4\u53d7\u6848\u5b57[2017]10568\u53f7",
			"xec": 3,
			"xsc": 3,
			"yec": 2,
			"ysc": 2
		}, {
			"word": "\u5e8f\u53f7",
			"xec": 1,
			"xsc": 1,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u8d23\u4efb\u8005",
			"xec": 2,
			"xsc": 2,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u5907\u6ce8",
			"xec": 7,
			"xsc": 7,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u9875\u53f7",
			"xec": 6,
			"xsc": 6,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u65e5\u671f",
			"xec": 5,
			"xsc": 5,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u6807\u9898",
			"xec": 4,
			"xsc": 4,
			"yec": 1,
			"ysc": 1
		}, {
			"word": "\u6587\u53f7",
			"xec": 3,
			"xsc": 3,
			"yec": 1,
			"ysc": 1
		}]
	]
}

```
- 请求参数 ‘return_json’ 不等于 ‘true' ,返回xlsx文件